



<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title></title>
<meta name="_csrf" content="5d4c381a-d01e-46fb-a6b0-ad82f35c3199" />
<meta name="_csrf_header" content="X-CSRF-TOKEN" />

        <meta http-equiv="refresh"	content="1800;url=/login">
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge" ><!-- content="text/html; charset=UTF-8" -->
<title>IGRS | Dashboard</title>
<!-- Tell the browser to be responsive to screen width -->
<meta content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no"
	name="viewport">
<!-- Bootstrap 3.3.7 -->
<link rel="stylesheet"
	href="/resources/bower_components/bootstrap/dist/css/bootstrap.min.css">
<link rel="stylesheet" href="/resources/css/jquery-ui.css">
<!-- Font Awesome -->
<link rel="stylesheet"
	href="/resources/bower_components/font-awesome/css/font-awesome.min.css">
<!-- Ionicons -->
<link rel="stylesheet" href="/resources/bower_components/datatables.net-bs/css/dataTables.bootstrap.min.css">
<link rel="stylesheet"
	href="/resources/bower_components/Ionicons/css/ionicons.min.css">
<!-- jvectormap -->
<!--<link rel="stylesheet"
	href="/resources/bower_components/jvectormap/jquery-jvectormap.css">-->
<!-- Theme style -->
<link rel="stylesheet"
	href="/resources/dist/css/AdminLTE.min.css">
<!-- AdminLTE Skins. Choose a skin from the css/skins
       folder instead of downloading all of them to reduce the load. -->
<link rel="stylesheet"
	href="/resources/dist/css/skins/_all-skins.min.css">
	
<link rel="stylesheet" href="/resources/bower_components/select2/dist/css/select2.min.css">

<!-- <link rel="stylesheet" href="/resources/bower_components/bootstrap-daterangepicker/daterangepicker.css"> -->
<!--   <!-- bootstrap datepicker --> 
<!--   <link rel="stylesheet" href="/resources/bower_components/bootstrap-datepicker/dist/css/bootstrap-datepicker.min.css"> -->
<!--   <!-- iCheck for checkboxes and radio inputs --> 
<!--   <link rel="stylesheet" href="/resources/plugins/iCheck/all.css"> -->
  
<!--   <!-- Bootstrap Color Picker --> 
<!--   <link rel="stylesheet" href="/resources/bower_components/bootstrap-colorpicker/dist/css/bootstrap-colorpicker.min.css"> -->
  <!-- Bootstrap time Picker -->


  <link rel="stylesheet" href="/resources/plugins/timepicker/bootstrap-timepicker.min.css"> 
     <link rel="stylesheet" href="/resources/css/jquery-ui.css"> 

   
<!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
<!-- WARNING: Respond.js doesn't work if you view the page via file:// -->



<!-- <link rel="stylesheet"
	href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,600,700,300italic,400italic,600italic">
 	-->
 <style>
.pagination {
	display: inline-block;
}

.pagination a {
	color: black;
	float: left;
	padding: 8px 16px;
	text-decoration: none;
	transition: background-color .3s;
	border: 1px solid #ddd;
}

.pagination a.active {
	background-color: #4CAF50;
	color: white;
	border: 1px solid #4CAF50;
}

.pagination a:hover:not (.active ) {
	background-color: #ddd;
}

.tfootc{
   background-color: lightblue;
    
}

.theadc{
   background-color: #d7f2ea
    
}

.theadh {
    background-color: #337094;
    font-size: 12px;
    text-align: center;
    color: white;
}

div.b {
  word-break: break-all;  
  line-height: 22px;
}

.left{
   text-align: left;
}
.right{
   text-align: right;
}
/**** dialogt mpr formula dialog css ****************/
   .dialogt{
                border:1px solid #8fa7cf;
                 padding: 3px;
                 text-align: center;
                 font-size: 14px
            } 
</style>

<style type="text/css">
#dvLoading {
	background: rgba(0%,0%,0%,0.609)
		url(/resources/assets/img/ajax-loader.gif)
		no-repeat center center;
	height: 100%;
	width: 100%;
	position: fixed;
	top: 0;
	bottom: 0;
	right: 0;
	left: 0;
	display: block;
	z-index: 2000;
}

.selecton{
    border: 3px solid #669999;
        border-collapse: collapse;
    
}

.text-warning {
    color: #000000 !important;
}

textarea {
   resize: none;
}
</style>


       

        <!-- Font Icon -->
        <link rel="stylesheet" href="fonts/material-icon/css/material-design-iconic-font.min.css">

                <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
        <!-- Main css -->
      
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/jquery-confirm/3.3.2/jquery-confirm.min.css">
        <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-confirm/3.3.2/jquery-confirm.min.js"></script>


</head>
<body
	style="background-image: url(/resources/assets/img/download.jpg); background-repeat: no-repeat; background-position: center; background-size: cover; color: white; width: 100%; height: 100%;">
<style>.jconfirm-title-c .jconfirm-title
,.jconfirm-title-c.jconfirm-icon-c
,.jconfirm-content div{
 color:#141313
}</style>

<div id="divalert" >
    
</div>

    <div class="col-xs-12" style="margin-top: 10px;">
		<form id="form" action="passwordReset" method="post" autocomplete="off">
			<div id="showhide">
			<div class="row">
				<div class="col-xs-4"></div>
				<div class="col-xs-4">
					<div class="form-group">
						<label for="username">
							यूसर आई डी
						</label>
						<b style="color: red;">*</b>
						<input id="username" name="username" class="form-control input-sm" type="text" value="" maxlength="50"/>
						

					</div>

				</div>
				<div class="col-xs-4" style="margin-top: 20px;">
					<button type="button" class="btn bg-orange" id="check"
						onclick="validate();">सबमिट करें </button>
                                                <a style="text-align: left" href="https://jansunwai.up.nic.in/" class="btn btn-info" >
           <i class="fa fa-home" style=" padding-right: 4px;"></i>
           होम</a>
                                </div>
                               
			</div>
			<div class="row">
				<div class="col-xs-4">
					<input type="hidden" id="mobile" /> <input type="hidden" id="email" />
				</div>
				<div class="col-xs-4">
					<div class="form-group">
						<div id="disp_moble" style="display: none;">
							<input id="rdbmobile" name="rdbmobemail" type="radio" value="1"/><label for="rdbmobile">Mobile</label>
							: <label id="mobileNo"></label>
						</div>
						<div id="disp_email" style="display: none;">
							<input id="rdbemail" name="rdbmobemail" type="radio" value="2"/><label for="rdbemail">Email</label>
							: <label id="emailid"></label>
						</div>

					</div>

				</div>
				<div class="col-xs-4" style="margin-top: 20px;"></div>
			</div>
			<div class="row">
				<div class="col-xs-4"></div>
				<div class="col-xs-4">

					<div class="form-group" style="display: none;"
						id="disp_mobileValid">
						<label for="mobile">
							मोबाइल नंबर
						</label>
						<b style="color: red;">*</b>
						<input id="mobileids" name="mobile" class="form-control input-sm" type="text" value="" maxlength="11"/>
						

					</div>

					<div class="form-group" style="display: none;" id="disp_emailValid">
						<label for="email">
							ई-मेल
						</label>
						<b style="color: red;">*</b>
						<input id="emailids" name="email" class="form-control input-sm" type="text" value="" maxlength="50"/>
						

					</div>


				</div>
				<div class="col-xs-4" style="margin-top: 20px;"><button type="button" class="btn bg-orange" id="sendMobileOTP"
						onclick="sendOneTimePasswordMobile();" style="display: none;">OTP प्राप्त करें</button>
				<button type="button" class="btn bg-orange" id="sendEmailOTP"
						onclick="sendOneTimePasswordEmail();" style="display: none;">OTP प्राप्त करें</button>
				</div>
				<div class="col-xs-4"></div>
			</div>
			<div class="row" style="display: none;" id="disp_validOTP">
			<div class="col-xs-4"></div>
			<div class="col-xs-4"><label for="validOTP">
							ओ०टी०पी० अंकित करें
						</label>
						<b style="color: red;">*</b>
						<input id="validOTP" name="validOTP" class="form-control input-sm" type="text" value="" maxlength="6"/>
						
			</div>
			<div class="col-xs-4" style="margin-top: 20px;" id="disp_validateCaptcha"><!-- <button type="button" class="btn bg-orange" id="validate" style="display: none;"
						onclick="validateOTP();">validate</button> --></div>
			</div>
			</div>
			<div id="reset">
			
			</div>


		<div>
<input type="hidden" name="_csrf" value="5d4c381a-d01e-46fb-a6b0-ad82f35c3199" />
</div></form>
	</div>
</body>

<script type="text/javascript">
   $(document).ready(function(){
	   $('#mobileids').on("cut copy paste",function(e) {
	      e.preventDefault();
	   });
	$('#emailids').on("cut copy paste",function(e) {
		      e.preventDefault();
		   });
	});
	//$('#disp_validOTP').show();
        
	$("#username").keydown(function() {

		if ($("#username").val() === '') {
			$("#emailid").html("");
			$("#disp_email").hide();
			$("#mobileNo").html("");
			$("#disp_moble").hide();
			$("#check").show();
			$("#disp_mobileValid").hide();
			$("#disp_emailValid").hide();
			$("#sendMobileOTP").hide();
			$("#sendEmailOTP").hide();
			$("#mobileids").val("");
			$("#emailids").val("");
		}
	});

	$("#check").on('click', function() {
		$("#check").hide();
	});

	
	
	$("#rdbmobile").on('click', function() {

		if ($("input[name='rdbmobemail']:checked").val() == 1) {
			$("#disp_mobileValid").show();
			$("#sendMobileOTP").show();
			$("#sendEmailOTP").hide();
			$("#disp_emailValid").hide();
			$("#mobileids").val("");
			$("#emailids").val("");
		} else {
			$("#disp_emailValid").show();
			$("#sendEmailOTP").show();
			$("#sendMobileOTP").hide();
			$("#disp_mobileValid").hide();
			$("#mobileids").val("");
			$("#emailids").val("");
		}
		
	});

	$("#rdbemail").on('click', function() {
		if ($("input[name='rdbmobemail']:checked").val() == 1) {
			$("#disp_mobileValid").show();
			$("#sendMobileOTP").show();
			$("#sendEmailOTP").hide();
			$("#disp_emailValid").hide();
			$("#mobileids").val("");
			$("#emailids").val("");
		} else {
			$("#disp_emailValid").show();
			$("#sendEmailOTP").show();
			$("#sendMobileOTP").hide();
			$("#disp_mobileValid").hide();
			$("#mobileids").val("");
			$("#emailids").val("");
		}
	});

	$("#mobileids").on('keyup',function() {

		if ($("#mobileids").val() == $("#mobile").val()) {
			$("#sendMobileOTP").show();
			$("#sendEmailOTP").hide();
		}
	});
	
	$("#emailids").on('keyup',function() {

		if ($("#emailids").val() == $("#email").val()) {
			$("#sendMobileOTP").hide();
			$("#sendEmailOTP").show();
		}
	});
	
	function validate() {
		var userName = $("#username").val();
		$
				.ajax({
					type : 'POST',
					url : '/getUserDetail?_csrf=5d4c381a-d01e-46fb-a6b0-ad82f35c3199',
					data : {
						userName : userName
					},
					success : function(resp) {
						if(resp!='')
							{
						if (resp[0].value_id != "" || resp[0].value_text_u != "") {
							if (resp[0].value_id != "") {

								$("#mobileNo").html(
										resp[0].value_id.replace(
												/\d(?=\d{4})/g, "*"));
								$("#mobile").val(resp[0].value_id);
								$("#disp_moble").show();

							}
							if (resp[0].value_text_u != "") {
								$("#emailid")
										.html(
												resp[0].value_text_u
														.slice(0, 4)
														+ (resp[0].value_text_u.length > 4 ? "***********"
																: ""));
								$("#email").val(resp[0].value_text_u);
								$("#disp_email").show();
							}

						}
						}
						else
							{
							alert("कृपया सही यूसर आई डी भरें");
							$("#username").val("");
							$("#check").show();
							}

					}
				});

	}
	
	function sendOneTimePasswordMobile(){
		var userName = $("#username").val();
		var userMobileNo = $("#mobileids").val();
		if($("#mobileids").val() == $("#mobile").val())
		{
		$("#sendMobileOTP").show();
                
		$.ajax({
			type : 'POST',
			url : '/getMobileOTPForPassword?_csrf=5d4c381a-d01e-46fb-a6b0-ad82f35c3199',
			data : {userName : userName,userMobileNo : userMobileNo},
			success : function(resp) {
				if(resp=='1' || resp=== 1)
				{        alert(" OTP भेजा गया "); 
					$("#disp_validOTP").show();
                                        $("#reset").html("<div class='row'><div class='col-xs-4'></div><div class='col-xs-4'><div class='form-group'><label>New Password</label><b style='color: red;'>*</b><input type='password' id='pass'  name='newpassword' class='form-control input-sm' maxlength='15'/></div><div class='form-group'><label path='password'>Re-Enter New Password</label><b style='color: red;'>*</b><input type='password' name='password' id='password' class='form-control input-sm' maxlength='15'/></div></div><div class='col-xs-4'></div></div><div class='row'><div class='col-xs-4'></div><div class='col-xs-4'><button type='button' class='btn btn-facebook' name='submitBtn' id='submitBtn1' onclick='validationSubmit();'>सबमिट करें </button></div><div class='col-xs-4'></div></div>");
					//$("#disp_validateCaptcha").html("<button type='button' class='btn bg-orange' id='validate'	onclick='validateOTP();'>validate</button>");
				}else if(resp=='400' || resp=== 400){
                                    alert("Send OTP After 30 Sec.");
                                }
				else{
					/* $("#disp_validOTP").show(); */
					alert("Service Down Unable to send OTP");
					$("#sendMobileOTP").show();
				}
				$("#sendMobileOTP").html("पुनः OTP भेजें");
                                $('#sendMobileOTP').removeClass('bg-orange');
                                $('#sendMobileOTP').addClass('btn-info');
			}
		});}
		else
			{
			alert("अमान्य मोबाइल न.");
			return false;
			}

	}
	
    function sendOneTimePasswordEmail(){
     	var userName = $("#username").val();
		var userEmailids = $("#emailids").val();
		if ($("#emailids").val() == $("#email").val()) {
		$("#sendMobileOTP").hide();
		$.ajax({
			type : 'POST',
			url : '/getEmailOTPForPassword?_csrf=5d4c381a-d01e-46fb-a6b0-ad82f35c3199',
			data : {userName : userName,userEmailids : userEmailids},
			success : function(resp) {
				if(resp==1)
				{
					$("#disp_validOTP").show();
					$("#disp_validateCaptcha").html("<button type='button' class='btn bg-orange' id='validate'	onclick='validateOTP();'>validate</button>");
				}
				else{
					/* $("#disp_validOTP").show(); */
					alert("Service Down Unable to send OTP");
					$("#sendMobileOTP").show();
				}
				
			}
		});}
		else
		{
		alert("In Valid Email Id.");
		return false;
		}
	}
    
    function validateOTP(){
    	
    	       var userName = $("#username").val();
		var validOTP = $("#validOTP").val();
		
		$("#validate").hide();
		$.ajax({
			type : 'POST',
			url : '/getPasswordOTPValidate?_csrf=5d4c381a-d01e-46fb-a6b0-ad82f35c3199',
			data : {userName : userName,validOTP : validOTP},
			success : function(resp) {
				if(resp==1)
				{
					$("#showhide").hide();
					$("#reset").html("<div class='row'><div class='col-xs-4'></div><div class='col-xs-4'><div class='form-group'><label>नया पासवर्ड भरें </label><b style='color: red;'>*</b><input type='password' name='newpassword' id='pass' autocomplete='off' class='form-control input-sm' maxlength='15'/></div><div class='form-group'><label path='password'>पुनः नया पासवर्ड भरें पासवर्ड भरें</label><b style='color: red;'>*</b><input type='password' name='password' id='password' autocomplete='off' class='form-control input-sm' maxlength='15'/></div></div><div class='col-xs-4'></div></div><div class='row'><div class='col-xs-4'></div><div class='col-xs-4'><button type='submit' class='btn btn-facebook' name='submitBtn' id='submitBtn1' onclick='return validationSubmit();'>सबमिट करें </button></div><div class='col-xs-4'></div></div>");
				}
				else{
					alert("ओ टी पी मान्य नहीं है कृपया सही ओटीपी भरें। ");
				} 
				
			}
		});

    }
    
   
    function validationSubmit(){
    
    //alert("");
    	var statusOnclose='NA';
                                 var passwordResetBean = $('#form').serialize();
                               
                                         $.confirm({
                                                    title: 'Reset Password',

                                                    content: 'क्या आप अपना पासवर्ड रिसेट करना चाहते है ',
                                                    type: 'orange',
                                                    backgroundDismiss: false,
                                                    backgroundDismissAnimation: 'glow',
                                                    typeAnimated: true,
                                                    buttons: {

                                                        हाँ: function () {

                                                            $.confirm({
                                                                content: function () {

                                                                    var self = this;
                                                                    return $.ajax({
                                                                        type: "POST",
                                                                       // enctype: 'multipart/form-data',
                                                                        url: "passwordReset?_csrf=5d4c381a-d01e-46fb-a6b0-ad82f35c3199",
                                                                        data: passwordResetBean,
                                                                        // prevent jQuery from automatically transforming the data into a query string
                                                                        processData: false,
                                                                        
                                                                        success: function (res, textStatus, jqXHR) {
                                                                            console.log("errs  : " + JSON.stringify(res));
                                                                            console.log("SUCCESS : ", res);
                                                                            console.log("SUCCESS : ", textStatus);
                                                                            if (res.validated) {
                                                                                console.log("SUCCESS : ", res);
                                                                                console.log("SUCCESS : ", textStatus);
                                                                                if (res.errorCode === 200 || res.errorCode === '200') {
                                                                                   // $('#divalert').show();
                                                                                   // $('#divform').hide();
                                                                                    statusOnclose='OKEJ';
                                                                                }
                                                                                self.setContent(res.status);
                                                                                self.setTitle("Status");
                                                                                
                                                                                
                                                                                //Set response
                                                                                //   $('#resultContainer pre code').text(JSON.stringify(res.employee));
                                                                                //  $('#resultContainer').show();
                                                                            } else {
                                                                                //Set error messages

                                                                                console.log("errs  : " + JSON.stringify(res));
                                                                                self.setContent('<span style="color:red">'+res.status+'</span>');
//                                                                                $.each(res.errorMessages, function (key, value) {
//                                                                                    self.setContentAppend('<br><span style="color:red">Error:</span> ' + value);                                                                              
//                                                                                    $('input[name=' + key + ']').after('<span class="error">' + value + '</span>');
//                                                                                    
//                                                                                });
                                                                                self.setTitle("Validation Failed");

                                                                            }

                                                                            // $("#submitButton").prop("disabled", false);
                                                                            // $('#fileUploadForm')[0].reset();
                                                                        },
                                                                        error: function (jqXHR, textStatus, errorThrown) {
                                                                            //   $("#result").html(jqXHR.responseText);
                                                                            console.log("ERROR : ", jqXHR.responseText);
                                                                            self.setContent("ERROR Code = 500");
                                                                            self.setTitle("Failed");
                                                                            //   $("#submitButton").prop("disabled", false);
                                                                        }
                                                                    });
                                                                },
                                                                onAction: function (btnName) {
        // when a button is clicked, with the button name
                                                                               //   alert('onAction: ' + btnName);
                                                                               },
                                                                 onDestroy: function () {
                                                                    //  alert('onAction onclose : ' + statusOnclose);
                                                                      if(statusOnclose==='OKEJ'){
                                                                      window.location="https://jansunwai.up.nic.in/login";
                                                                  }
                                                                      }              
                                                            });
                                            

                                                        },
                                                        नहीं: function () {
                                                            $.alert('कोई कार्यवाही नहीं की गयी !');
                                                        }
                                                     }
                                                });
        
        
    	
    }
    
    
    
        
    
    
    
    
    
    
    
    
</script>




</html>